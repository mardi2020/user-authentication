## ğŸ“Œ í•µì‹¬ ê¸°ëŠ¥

### Spring Cloud Gateway

1. ë¡œë“œë°¸ëŸ°ì‹±
2. ë¼ìš°íŒ…
    - ê° microserviceì˜ í¬íŠ¸ë²ˆí˜¸ë¡œ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ gatewayì˜ í¬íŠ¸ë²ˆí˜¸ë¥¼ í†µí•´ì„œ APIë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
    - localhost:12345/user-service/users X â†’ localhost:8000/user-service/users O
3. Filter
    - JWT í† í° ìœ íš¨ì„± ê²€ì¦
    - ì‚¬ìš©ìì˜ ROLEì„ ê¸°ë°˜ìœ¼ë¡œ ìš”ì²­ ì²˜ë¦¬
    - controllerì—ì„œ í•´ë‹¹ ìš”ì²­ì˜ token ê°’ ë‚´ì˜ roleì´ ADMINì¸ì§€ íŒë‹¨í•˜ì˜€ìœ¼ë‚˜, ìš”ì²­ì´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ê¹Œì§€ ì „ë‹¬ë˜ì–´ ì²˜ë¦¬ë˜ëŠ” ê²ƒë³´ë‹¤ gatewayì—ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì˜¬ë°”ë¥´ë‹¤ê³  íŒë‹¨í•˜ì—¬ gatewayì—ì„œ filterë¡œ ë³€ê²½í–ˆë‹¤.
      - [Cloud Gatewayì˜ RoleFilter](https://github.com/mardi2020/user-authentication/blob/main/apiGateway/src/main/java/com/mardi202/apigateway/filter/RoleFilter.java)
5. ë¡œê·¸ì¸
    - userService.loadUserByUsername()ìœ¼ë¡œ emailë¡œ ê°€ì…ëœ user ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
    - ì¸ì¦ì´ ì„±ê³µí•˜ë©´ jwt í† í° ë°œí–‰í•˜ì—¬ headerì— token, userIdë¥¼ í¬í•¨í•˜ì—¬ ì‘ë‹µí•œë‹¤.
        - subject: userId
        - claim: role  
        - expriation: currentTimeMillis + expirationTime
        - signWith: HS512 ì•Œê³ ë¦¬ì¦˜, key=token_key

### join service

1. íšŒì›ê°€ì…
    - ì…ë ¥ëœ email, name, passwordì˜ ê°’ì„ ê²€ì¦í•œë‹¤.
        - email: email í˜•ì‹ì— ë§ëŠ”ì§€ í™•ì¸, unique
        - name: 3ê¸€ì ì´ìƒ 5ê¸€ì ì´í•˜, unique
        - password: 8ê¸€ì ì´ìƒ
        - ê°€ì…ëœ email, nameì€ join serviceì˜ redis ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì–´ user serviceì˜ í˜¸ì¶œì—†ì´ ì¤‘ë³µì„ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤.
    - user serviceì˜ ì‚¬ìš©ì ì €ì¥ APIë¥¼ í˜¸ì¶œí•˜ì—¬ user DBì— ì •ë³´ë¥¼ ì €ì¥í•œë‹¤.
2. íšŒì›íƒˆí‡´
    - ë¡œê·¸ì¸ë˜ì–´ ìˆëŠ” íšŒì›ì´ íƒˆí‡´ ìš”ì²­í•  ë•Œ íƒˆí‡´í•˜ëŠ” APIì´ë‹¤.
    - ë¡œê·¸ì¸ì´ ë˜ì–´ìˆëŠ” íšŒì›ì— í•œí•´ì„œë§Œ íƒˆí‡´ê°€ ê°€ëŠ¥í•˜ë¯€ë¡œ ì‚¬ìš©ìê°€ ê°€ì§„ tokenì˜ ê°’ì„ ê²€ì¦í•´ì•¼ í•œë‹¤.
        - spring cloud gatewayì˜ filterì—ì„œ ê²€ì¦
    - request: userId
    - user serviceì˜ ì‚¬ìš©ì ì‚­ì œ APIë¥¼ í˜¸ì¶œí•˜ì—¬ userIdì— í•´ë‹¹í•˜ëŠ” ì‚¬ìš©ìë¥¼ DBì—ì„œ ì‚­ì œí•œë‹¤.

### find info service

1. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
    - request: name, email
    - name, emailë¡œ ì €ì¥ëœ ì •ë³´ê°€ ìˆë‹¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
    - user serviceë¡œ requestë¥¼ ì „ë‹¬í•˜ì—¬ ë³€ê²½ì„ ìˆ˜í–‰í•œë‹¤.
2. ì´ë©”ì¼ ì°¾ê¸°
    - request: name
    - nameì€ uniqueí•œ ê°’ì´ë¯€ë¡œ nameìœ¼ë¡œ emailì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.
    - user serviceë¡œ requestë¥¼ ì „ë‹¬í•˜ì—¬ ë“±ë¡ëœ email ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.

### user manage service - ADMIN ì „ìš©

1. ê°€ì…ëœ ì‚¬ìš©ìë“¤ì„ ëª¨ì•„ë³´ëŠ” ê¸°ëŠ¥
    - user serviceë¡œ ëª¨ë“  ì‚¬ìš©ì ê°€ì ¸ì˜¤ê¸° APIë¥¼ í˜¸ì¶œí•˜ì—¬ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
    - userì˜ email, name ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.